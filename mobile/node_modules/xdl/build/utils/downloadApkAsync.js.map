{"version":3,"file":"downloadApkAsync.js","sourceRoot":"","sources":["../../src/utils/downloadApkAsync.ts"],"names":[],"mappings":";;;;;AAAA,wDAA0B;AAC1B,gDAAwB;AAExB,0CAA0D;AAE1D,SAAS,kBAAkB;IACzB,MAAM,oBAAoB,GAAG,uBAAY,CAAC,oBAAoB,EAAE,CAAC;IACjE,MAAM,GAAG,GAAG,cAAI,CAAC,IAAI,CAAC,oBAAoB,EAAE,mBAAmB,CAAC,CAAC;IACjE,kBAAE,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;IACnB,OAAO,GAAG,CAAC;AACb,CAAC;AAEM,KAAK,UAAU,gBAAgB,CACpC,GAAY,EACZ,wBAA4D;IAE5D,IAAI,CAAC,GAAG,EAAE;QACR,MAAM,QAAQ,GAAG,MAAM,mBAAQ,CAAC,aAAa,EAAE,CAAC;QAChD,GAAG,GAAG,QAAQ,CAAC,UAAU,CAAC;KAC3B;IAED,MAAM,QAAQ,GAAG,cAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;IACtC,MAAM,OAAO,GAAG,cAAI,CAAC,IAAI,CAAC,kBAAkB,EAAE,EAAE,GAAG,QAAQ,MAAM,CAAC,CAAC;IAEnE,IAAI,MAAM,kBAAE,CAAC,UAAU,CAAC,OAAO,CAAC,EAAE;QAChC,OAAO,OAAO,CAAC;KAChB;IAED,MAAM,cAAG,CAAC,aAAa,CAAC,GAAG,EAAE,OAAO,EAAE,SAAS,EAAE,wBAAwB,CAAC,CAAC;IAC3E,OAAO,OAAO,CAAC;AACjB,CAAC;AAlBD,4CAkBC","sourcesContent":["import fs from 'fs-extra';\nimport path from 'path';\n\nimport { Api, UserSettings, Versions } from '../internal';\n\nfunction _apkCacheDirectory() {\n  const dotExpoHomeDirectory = UserSettings.dotExpoHomeDirectory();\n  const dir = path.join(dotExpoHomeDirectory, 'android-apk-cache');\n  fs.mkdirpSync(dir);\n  return dir;\n}\n\nexport async function downloadApkAsync(\n  url?: string,\n  downloadProgressCallback?: (roundedProgress: number) => void\n) {\n  if (!url) {\n    const versions = await Versions.versionsAsync();\n    url = versions.androidUrl;\n  }\n\n  const filename = path.parse(url).name;\n  const apkPath = path.join(_apkCacheDirectory(), `${filename}.apk`);\n\n  if (await fs.pathExists(apkPath)) {\n    return apkPath;\n  }\n\n  await Api.downloadAsync(url, apkPath, undefined, downloadProgressCallback);\n  return apkPath;\n}\n"]}