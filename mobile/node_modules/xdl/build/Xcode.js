"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const spawn_async_1 = __importDefault(require("@expo/spawn-async"));
const internal_1 = require("./internal");
// Based on the RN docs (Aug 2020).
exports.minimumVersion = 9.4;
exports.appStoreId = '497799835';
async function getXcodeVersionAsync() {
    try {
        const { stdout } = await spawn_async_1.default('xcodebuild', ['-version']);
        const match = stdout.match(/^Xcode (\d+\.\d+)/);
        if (match === null || match === void 0 ? void 0 : match.length) {
            const last = match.pop();
            // Convert to a semver string
            if (last) {
                return `${last}.0`;
            }
            return null;
        }
        // not sure what's going on
        internal_1.Logger.global.error('Unable to check Xcode version. Command ran successfully but no version number was found.');
    }
    catch (_a) {
        // not installed
    }
    return null;
}
exports.getXcodeVersionAsync = getXcodeVersionAsync;
/**
 * Open a link to the App Store. Just link in mobile apps, **never** redirect without prompting first.
 *
 * @param appId
 */
async function openAppStoreAsync(appId) {
    const link = getAppStoreLink(appId);
    await spawn_async_1.default('open', [link]);
}
exports.openAppStoreAsync = openAppStoreAsync;
function getAppStoreLink(appId) {
    if (process.platform === 'darwin') {
        // TODO: Is there ever a case where the macappstore isn't available on mac?
        return `macappstore://itunes.apple.com/app/id${appId}`;
    }
    return `https://apps.apple.com/us/app/id${appId}`;
}
//# sourceMappingURL=Xcode.js.map